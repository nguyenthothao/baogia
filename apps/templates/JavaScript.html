<script defer>
  // Prevent forms from submitting.
  function preventFormSubmit() {
    var forms = document.querySelectorAll('form');
    for (var i = 0; i < forms.length; i++) {
      forms[i].addEventListener('submit', function(event) {
        event.preventDefault();
      });
    }
  }
  window.addEventListener("load", functionInit, true); 
  
  // INITIALIZE Decal Form
  function initDecalForm() {
    var $form = $("#decalForm"); 

    // Populate dropdowns with data from the spreadsheet
    $form.find('select').each(function() {
      var $select = $(this);
      var name = $select.attr('name');
      google.script.run.withSuccessHandler(function(options) {
        console.log({options});
        $select.empty();
        options.forEach(function(option) {
          $select.append('<option value="' + option + '">' + option + '</option>');
        });
      }).getDropdownOptions('Decal', name);
    });
  }
  
  //HANDLE FORM SUBMISSION
  function handleFormSubmit(formObject) {
    google.script.run.withSuccessHandler(createTable).Decal(formObject);
    document.getElementById("decalForm").reset();
  }
  
  //CREATE THE DATA TABLE
  function createTable(data) {
    console.log({data});
    if (data && data.success) {
      document.getElementById("soToIn").innerText = data.soToIn;
      document.getElementById("buHao").innerText = data.soToCon;
    }
  }

  //INITIALIZE FUNCTIONS ONLOAD
  function functionInit(){  
    preventFormSubmit();
    initDecalForm();
  };
</script>
